<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</title>
<style>
body { font-family:'Arial',sans-serif; margin:0; padding:20px; background:#f0f2f5; }
h2 { text-align:center; margin-bottom:20px; color:#333; }

/* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØµÙØ­Ø§Øª */
.pages-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(140px,1fr)); gap:15px; margin-bottom:20px; }
.page-card { background:#fff; padding:20px; text-align:center; border-radius:12px; box-shadow:0 4px 8px rgba(0,0,0,0.1); cursor:pointer; transition:0.2s; font-weight:bold; color:#333; }
.page-card:hover { transform:scale(1.05); box-shadow:0 6px 12px rgba(0,0,0,0.2); }

/* Ø§Ù„Ø¨Ø­Ø« */
#searchContainer { display:flex; justify-content:flex-start; align-items:center; margin-bottom:10px; gap:10px; display:none; }
#searchInput { padding:8px; border-radius:5px; border:1px solid #ccc; flex:1; }
#searchOption { padding:8px; border-radius:5px; border:1px solid #ccc; }

/* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
.products-grid { display:none; grid-template-columns:repeat(auto-fill,minmax(180px,1fr)); gap:15px; }
.product-card { background:#fff; border-radius:10px; padding:10px; box-shadow:0 2px 6px rgba(0,0,0,0.1); text-align:center; position:relative; transition:0.2s; }
.product-card:hover { transform:scale(1.02); }
.product-card img { width:100px; height:100px; object-fit:cover; border-radius:8px; margin-bottom:5px; }
.product-card input { width:90%; margin-bottom:5px; border:none; text-align:center; font-weight:bold; }
.product-card .price { color:#555; margin-bottom:5px; }
.product-card .dropdown { position:absolute; top:10px; right:10px; cursor:pointer; font-size:20px; }
.dropdown-content { display:none; position:absolute; top:30px; right:0; background:#fff; min-width:100px; box-shadow:0 2px 6px rgba(0,0,0,0.2); border-radius:6px; overflow:hidden; z-index:1; }
.dropdown-content button { width:100%; padding:5px; border:none; background:#fff; cursor:pointer; text-align:left; }
.dropdown-content button:hover { background:#f1f1f1; }

/* Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ */
#addProductForm { display:none; margin-bottom:10px; }
#addProductForm input { width:30%; padding:6px; margin-right:5px; border-radius:5px; border:1px solid #ccc; }
#addProductForm button { padding:6px 12px; border:none; border-radius:5px; background:#007bff; color:#fff; cursor:pointer; }

#saveBtn { margin-top:10px; padding:8px 12px; border:none; border-radius:6px; background:#28a745; color:#fff; cursor:pointer; display:none; }

@media(max-width:600px){ .products-grid { grid-template-columns:repeat(2,1fr); } #addProductForm input { width:100%; margin-bottom:5px; } }
</style>
</head>
<body>
<h2>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h2>

<!-- Ø§Ù„ØµÙØ­Ø§Øª -->
<div class="pages-grid" id="pagesGrid"></div>

<!-- Ø§Ù„Ø¨Ø­Ø« -->
<div id="searchContainer">
  <select id="searchOption">
    <option value="name">Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…</option>
    <option value="price">Ø¨Ø­Ø« Ø¨Ø§Ù„Ø³Ø¹Ø±</option>
  </select>
  <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬..." oninput="filterProducts()">
</div>

<!-- Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ -->
<div id="addProductForm">
  <input type="text" id="productName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
  <input type="number" id="productPrice" placeholder="Ø§Ù„Ø³Ø¹Ø±">
  <input type="text" id="productImage" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©">
  <button onclick="addProduct()">Ø¥Ø¶Ø§ÙØ©</button>
</div>

<!-- Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
<div class="products-grid" id="productsGrid"></div>

<button id="saveBtn" onclick="saveChanges()">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, getDocs, addDoc, updateDoc, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyDQ2ZkGiIKE5odbXsZD03on_OcIuUbkJmg",
  authDomain: "pharmacy-store-bc240.firebaseapp.com",
  projectId: "pharmacy-store-bc240",
  storageBucket: "pharmacy-store-bc240.appspot.com",
  messagingSenderId: "328904695111",
  appId: "1:328904695111:web:4c4d8625e463d127af8062",
  measurementId: "G-FDCS1S483F"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Ø§Ù„ØµÙØ­Ø§Øª
const pages = ["Index.html","Childrens-supplies","Dental-care","Deodorants-perfumes","Diapers","Dyes","Good-supplies","Hair","Offer","Sensitive-area-care","Shaving-supplies","Skin","Sunscreen"];

// Ù…Ù†ØªØ¬Ø§Øª ÙŠØ¯ÙˆÙŠØ© Ù…ÙˆØ¬ÙˆØ¯Ø© Ù…Ø³Ø¨Ù‚Ù‹Ø§
const manualProducts = {
  "Index.html":[{name:"Ù…Ù†ØªØ¬ 1", price:10, image:"https://via.placeholder.com/50"}],
  "Childrens-supplies":[{name:"Ù…Ù†ØªØ¬ 2", price:20, image:"https://via.placeholder.com/50"}],
};

const pageIcons = {
  "Index.html": "ğŸ ",
  "Childrens-supplies": "ğŸ‘¶",
  "Dental-care": "ğŸ¦·",
  "Deodorants-perfumes": "ğŸŒ¸",
  "Diapers": "ğŸ§·",
  "Dyes": "ğŸ¨",
  "Good-supplies": "ğŸ›ï¸",
  "Hair": "ğŸ’‡â€â™€ï¸",
  "Offer": "ğŸ·ï¸",
  "Sensitive-area-care": "ğŸ§´",
  "Shaving-supplies": "ğŸª’",
  "Skin": "ğŸ§´",
  "Sunscreen": "â˜€ï¸"
};

const pagesGrid=document.getElementById("pagesGrid");
const productsGrid=document.getElementById("productsGrid");
const addProductForm=document.getElementById("addProductForm");
const saveBtn=document.getElementById("saveBtn");
const searchInput=document.getElementById("searchInput");
const searchOption=document.getElementById("searchOption");
const searchContainer=document.getElementById("searchContainer");

let currentPage="";
let products=[];
let edited=false;

// Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„ØµÙØ­Ø§Øª
pages.forEach(page=>{
  const div=document.createElement("div");
  div.className="page-card";
  div.innerHTML = `${pageIcons[page] || ''} ${page}`;
  div.onclick=()=>selectPage(page);
  pagesGrid.appendChild(div);
});

// Ø§Ø®ØªÙŠØ§Ø± ØµÙØ­Ø©
async function selectPage(page){
  currentPage=page;
  pagesGrid.style.display="none";
  addProductForm.style.display="block";
  productsGrid.style.display="grid";
  saveBtn.style.display="inline-block";
  searchContainer.style.display="flex";

  products=[];

  // Ø¬Ù„Ø¨ Ù…Ù†ØªØ¬Ø§Øª Firebase
  const querySnapshot = await getDocs(collection(db,page));
  querySnapshot.forEach(docSnap=>{
    products.push({id:docSnap.id, ...docSnap.data()});
  });

  // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ÙŠØ¯ÙˆÙŠØ©
  if(manualProducts[page]) products.push(...manualProducts[page]);

  renderProducts();
}

// Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
function renderProducts(){
  productsGrid.innerHTML="";
  products.forEach((p,i)=>{
    const div=document.createElement("div");
    div.className="product-card";
    div.innerHTML=`
      <img src="${p.image||'https://via.placeholder.com/100'}">
      <input type="text" value="${p.name}" onchange="markEdited(${i},'name',this.value)">
      <input type="number" value="${p.price}" onchange="markEdited(${i},'price',this.value)">
      <div class="dropdown" onclick="toggleDropdown(${i})">â‹®
        <div class="dropdown-content" id="dropdown-${i}">
          <button onclick="editProduct(${i})">ØªØ¹Ø¯ÙŠÙ„</button>
          <button onclick="deleteProduct(${i})">Ù…Ø³Ø­</button>
        </div>
      </div>
    `;
    productsGrid.appendChild(div);
  });
}

// ØªÙ…ÙŠÙŠØ² Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…Ø¹Ø¯Ù„
function markEdited(i,field,value){
  products[i][field]=field==='price'? parseFloat(value):value;
  edited=true;
}

// ÙØªØ­/Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
function toggleDropdown(i){
  const el=document.getElementById(`dropdown-${i}`);
  el.style.display=el.style.display==='block'?'none':'block';
}

// Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯
function addProduct(){
  const name=document.getElementById("productName").value;
  const price=parseFloat(document.getElementById("productPrice").value);
  const image=document.getElementById("productImage").value;
  if(!name||!price){alert("Ø§Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø³Ø¹Ø±"); return;}
  products.push({name,price,image});
  renderProducts();
  document.getElementById("productName").value="";
  document.getElementById("productPrice").value="";
  document.getElementById("productImage").value="";
  edited=true;
}

// ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬
function editProduct(i){
  const newName=prompt("ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…:", products[i].name);
  if(newName!==null) products[i].name=newName;
  const newPrice=prompt("ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø¹Ø±:", products[i].price);
  if(newPrice!==null) products[i].price=parseFloat(newPrice);
  const newImage=prompt("ØªØ¹Ø¯ÙŠÙ„ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©:", products[i].image);
  if(newImage!==null) products[i].image=newImage;
  alert("ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ âœ…");
  renderProducts();
  edited=true;
}

// Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬
async function deleteProduct(i){
  if(!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ØŸ")) return;
  if(products[i].id) await deleteDoc(doc(db,currentPage,products[i].id));
  products.splice(i,1);
  renderProducts();
  alert("ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ âœ…");
  edited=true;
}

// Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
async function saveChanges(){
  for(const p of products){
    if(p.id) await updateDoc(doc(db,currentPage,p.id),{name:p.name,price:p.price,image:p.image});
    else await addDoc(collection(db,currentPage),{name:p.name,price:p.price,image:p.image});
  }
  alert("ØªÙ… Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª âœ…");
  edited=false;
}

// Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
function filterProducts(){
  const val=searchInput.value.toLowerCase();
  const opt=searchOption.value;
  productsGrid.querySelectorAll(".product-card").forEach((card,i)=>{
    const name=products[i].name.toLowerCase();
    const price=products[i].price.toString();
    card.style.display=(opt==='name'?name.includes(val):price.includes(val))?"block":"none";
});
}
</script>
</body>
</html>